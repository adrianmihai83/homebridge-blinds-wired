<SPAN ALIGN="CENTER">

[![homebridge-blinds-wired: Native HomeKit support for non-smart motorized blinds through wires](https://github.com/adrianmihai83/homebridge-blinds-wired/blob/main/homebridge-blinds-wired.svg)](https://github.com/adrianmihai83/homebridge-blinds-wired)

# Homebridge Blinds Wired

[![Downloads](https://img.shields.io/npm/dt/homebridge-blinds-wired?color=%23333333&logo=icloud&logoColor=%23FFFFFF&style=for-the-badge)](https://www.npmjs.com/package/homebridge-blinds-wired)
[![Version](https://img.shields.io/npm/v/homebridge-blinds-wired?label=Homebridge%20Blinds%20Wired&color=%23333333&style=for-the-badge&logoColor=%23FFFFFF&logo=data:image/svg%2bxml;base64,PHN2ZyB3aWR0aD0iMTAyNHB4IiBoZWlnaHQ9IjEwMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CjxnIHN0eWxlPSIiPiAgPHBhdGggZD0iTTg2LjI5MTAwMCwyMjIuNTIyOTk1IEwzNy41MDA5OTksMjk3LjE1OTk5NiBMOTg2LjUwMDAyMywyOTcuMTU5OTk2IEw5MzcuNzEwMDIyLDIyMi41Mjg5OTkgTDg2LjI4NzA0OCwyMjIuNTI4OTk5IEw4Ni4yOTEwMDAsMjIyLjUyMjk5NSBaICIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHlsZT0iZmlsbDogcmdiYSgyNTUsIDI1NSwgMjU1LCAxLjAwMDAwMCk7IHN0cm9rZS13aWR0aDogNDEuMTA3NDk4cHg7IHN0cm9rZTogKG51bGwpOyAiIGZpbGw9IiNmZWZmZmYiIHN0cm9rZT0iIyhudWxsKSIgc3Ryb2tlLXdpZHRoPSI0MS4xMDc0OTgiIC8+CiAgPHBhdGggZD0iTTg2LjI5MTAwMCwzOTAuNjI4OTk4IEwzNy41MDA5OTksNDY1LjI2NTk5OSBMOTg2LjUwMDAyMyw0NjUuMjY1OTk5IEw5MzcuNzEwMDIyLDM5MC42MzUwMDIgTDg2LjI4NzA0OCwzOTAuNjM1MDAyIEw4Ni4yOTEwMDAsMzkwLjYyODk5OCBaICIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHlsZT0iZmlsbDogcmdiYSgyNTUsIDI1NSwgMjU1LCAxLjAwMDAwMCk7IHN0cm9rZS13aWR0aDogNDEuMTA3NDk4cHg7IHN0cm9rZTogKG51bGwpOyAiIGZpbGw9IiNmZWZmZmYiIHN0cm9rZT0iIyhudWxsKSIgc3Ryb2tlLXdpZHRoPSI0MS4xMDc0OTgiIC8+CiAgPHBhdGggZD0iTTg2LjI5MTAwMCw1NTguNzM0MDA5IEwzNy41MDA5OTksNjMzLjM3MTAxMCBMOTg2LjUwMDAyMyw2MzMuMzcxMDEwIEw5MzcuNzEwMDIyLDU1OC43NDAwMTMgTDg2LjI4NzA0OCw1NTguNzQwMDEzIEw4Ni4yOTEwMDAsNTU4LjczNDAwOSBaICIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHlsZT0iZmlsbDogcmdiYSgyNTUsIDI1NSwgMjU1LCAxLjAwMDAwMCk7IHN0cm9rZS13aWR0aDogNDEuMTA3NDk4cHg7IHN0cm9rZTogKG51bGwpOyAiIGZpbGw9IiNmZWZmZmYiIHN0cm9rZT0iIyhudWxsKSIgc3Ryb2tlLXdpZHRoPSI0MS4xMDc0OTgiIC8+CiAgPHBhdGggZD0iTTg2LjI5MTAwMCw3MjYuODQwMDI3IEwzNy41MDA5OTksODAxLjQ3NzAyOCBMOTg2LjUwMDAyMyw4MDEuNDc3MDI4IEw5MzcuNzEwMDIyLDcyNi44NDYwMzEgTDg2LjI4NzA0OCw3MjYuODQ2MDMxIEw4Ni4yOTEwMDAsNzI2Ljg0MDAyNyBaICIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHlsZT0iZmlsbDogcmdiYSgyNTUsIDI1NSwgMjU1LCAxLjAwMDAwMCk7IHN0cm9rZS13aWR0aDogNDEuMTA3NDk4cHg7IHN0cm9rZTogKG51bGwpOyAiIGZpbGw9IiNmZWZmZmYiIHN0cm9rZT0iIyhudWxsKSIgc3Ryb2tlLXdpZHRoPSI0MS4xMDc0OTgiIC8+CjwvZz48L3N2Zz4=)](https://www.npmjs.com/package/homebridge-blinds-wired)

## HomeKit support for non-smart motorized blinds through wires.

</SPAN>

`homebridge-blinds-wired` is a [Homebridge](https://homebridge.io) plugin that allows you to raise, lower, and stop your window blinds by wires. It makes a HomeKit window covering accessory available to you that can report status and be controlled entirely through wires.
These days, there is a decent selection of window blinds available on the market with native HomeKit support. However, there are also blinds systems, such as Somfy, which don't have any meaningful HomeKit support. Add to that the proprietary remote protocols and you're in for a challenge in trying to make window blinds part of your [HomeKit](https://www.apple.com/ios/home) smart home.

## Installation

If you are new to Homebridge, please first read the [Homebridge](https://homebridge.io) [documentation](https://github.com/homebridge/homebridge/wiki) and installation instructions before proceeding.

If you have installed the [Homebridge Config UI](https://github.com/oznu/homebridge-config-ui-x), you can intall this plugin by going to the `Plugins` tab and searching for `homebridge-blinds-wired` and installing it.

If you prefer to install `homebridge-blinds-wired` from the command line, you can do so by executing:

```sh
sudo npm install -g homebridge-blinds-wired
```

## Dependencies

Make sure `rpi-gpio` is installed...

`npm install rpi-gpio`

## Configuration

I strongly recommend using the [Homebridge Config UI](https://github.com/oznu/homebridge-config-ui-x) rather than editing your config.json directly. It does a good job of showing you all the options and always generating a valid configuration so you don't get stuck on typos or looking for stray commas in your `config.json`.

For those that prefer configuring things directly, add the accessory in `config.json` in your home directory inside `.homebridge`.

```js
   "platforms": [
     {
       "platform": "Blinds Wired",

       "blinds": [
         {
            "name": "Livingroom Curtains",
            "upPin": 11,
            "downPin": 13,
            "stopPin": 99,
            "pulseDuration": 200,
            "activeLow": "true",
            "transitionInterval": 15,
            "manufacturer": "Somfy",
            "model": "DCT",
            "serial": "1234-5678"
         }
      ]
    }
  ]
```

### Options

- `upPin`, `downPin` and `stopPin` should point to the Rpi GIOs.
- Setting a `stopPin` command in conjunction with a `transitionInterval` will allow you to simulate partially opening or closing your blinds, enabling scenarios such as asking HomeKit to open the blind to a certain percentage (e.g. Hey Siri, set the blinds to 30%). In case of Somfy DCT, stop is realised by pulsing both `upPin` and `downPin`, in this case you should use a value of 99 for `stopPin`
- `pulseDuration` is the value in miliseconds needed to trigger pins, 200ms is a good value for Somfy DCT.
- `activeLow` is the relay board active low? in this case use `true`, else... `false`
- `transitionInterval` is an optional setting that allows you to simulate a blind transition movement between open and closed. If it takes 15 seconds for the blinds to open, enter `15` here and `homebridge-blinds-wired` will simulate the time it takes to complete that transition in HomeKit. The default is 10 seconds.
- `manufacturer`, `model`, and `serial` are optional settings to allow you to further identify your blinds in HomeKit.

## Notes

This plugin doesn't query nor have direct knowledge of the actual position of your blinds. Instead, it emulates the position based on your most recent request to raise / lower the blinds (i.e. it remembers what you last asked it to do and reports that back to HomeKit). Some blinds, such as Somfy, don't support querying their specific state. That said, if you do wish to use a specific position, you can do so. It's passed as the last argument to the up and down script configuration options. How you choose to handle it, is up to you. What your plugin should output is the position it wants to HomeKit (e.g. 100 if the blind is fully open).

Additionally, if you specify `transitionInterval` and `stopPin` you'll magically get the ability to move the blind a precise amount. For instance, if you try to open the blind to 20%, `homebridge-blinds-wired` will pulsen the `upPin` and then use `transitionInterval` to figure out how many seconds to allow the blinds to move before pulsing the `stopPin`. The result, if you have `transitionInterval` correctly calculated for your blinds, should be relatively precise placement of your blinds at home - something that many popular blinds (e.g. Somfy), can't do natively!

## Plugin Development

[![License](https://img.shields.io/npm/l/homebridge-blinds-wired?color=%23333333&logo=open%20source%20initiative&logoColor=%23FFFFFF&style=for-the-badge)](https://github.com/adrianmihai83/homebridge-blinds-wired/blob/master/LICENSE.md)
